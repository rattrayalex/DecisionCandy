{% extends "base.html" %}

{% block title %}{{ block.super }} | Rank {{ Project.name }} {% endblock %}

{% block headcode %}
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
<script type="text/javascript" src="../../front-end/media/static/ajax-thing.js"></script>
<script type="text/javascript">
  var progress = 0;
  var project = "{{ Project.name|escapejs }}";
  
  var limit = '{{ limit }}';
  function vote(w, l){
	  var url = "/vote/";
	  var message = new Object();
	  message.winner = w;
	  message.loser = l;
	  $.post(url, {
		  winner: w, 
		  loser: l
	  	},
		function(data, status, xhr){
			if (status == 'success'){
				updateList('y');
			}
			else { 
				alert("something went wrong");
			}
		}
		);

	  //updateList('y');
  }
  
//  var pairs = new Array(limit);
//  
//  function isNewPair(l, r){
//	  
//  }
  
  function updateList(q){
    if (progress < limit) {
		if (q != 'n') {
		  progress += 1;
		}
		  var url = "../../../choices/" + project.replace(' ','%20');
		  $("div#main").load(url);
		  $("div#progress").html(progress + " / " + limit);	  
    }
    else {
      var url = "../../../thanks/"+ project.replace(' ','%20');
      $('div#content').load(url);
    }
  }

$(document).ready(function() {
//	for (i=0; i < limit; i++) {
//	  pairs[i] = new Array(2);
//	  pairs[i][0]="";
//	  pairs[i][1]="";
//	  }
    updateList('y');
    });
  </script>
  {% endblock %}

  {% block content %}

  <div class="bigtext frontcenter bluetext" id="whichone">Which one...</div>

  <div class="bigtext orangetext" id="isbest" title="{{ Project.more_criteria }}">
    {{ Project.criteria }}?
    <div class="littlelink">
      <span class="bluetext" title="{{ Project.more_criteria }}">
        hover for more criteria
      </span>
        <div class="progressbar">
            <div id="progress">
            </div>
            <br/>
            {% if Project.reward > 0 %}$
            {{ Project.reward }}
            {% endif %}
        </div>
    </div>
  </div>

  <div id="main">
  </div>


  <!--everything below the ranking goes here -->
  <div class="belowranking">   
    <div class="projectinfo">
      <div class="bigtext">Information about {{ Project.name }}</div>
      <div id="projdescription"> {{ Project.description }} </div>
    </div>
  </div>

  
</div>

{% endblock content %}
